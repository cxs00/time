//
//  PomodoroWebView.swift
//  time
//
//  番茄时钟 WebView 封装
//

import SwiftUI
import WebKit

struct PomodoroWebView: View {
    var body: some View {
        WebView()
            .edgesIgnoringSafeArea(.all)
    }
}

struct WebView: UIViewRepresentable {
    func makeUIView(context: Context) -> WKWebView {
        let configuration = WKWebViewConfiguration()
        let webView = WKWebView(frame: .zero, configuration: configuration)
        
        // 加载本地HTML文件
        if let htmlPath = Bundle.main.path(forResource: "index", ofType: "html", inDirectory: "Web") {
            let htmlURL = URL(fileURLWithPath: htmlPath)
            let htmlFolder = htmlURL.deletingLastPathComponent()
            webView.loadFileURL(htmlURL, allowingReadAccessTo: htmlFolder)
        } else {
            // 如果找不到本地文件，加载localhost
            if let url = URL(string: "http://localhost:8000") {
                let request = URLRequest(url: url)
                webView.load(request)
            }
        }
        
        return webView
    }
    
    func updateUIView(_ uiView: WKWebView, context: Context) {
        // 不需要更新
    }
}

#Preview {
    PomodoroWebView()
}

