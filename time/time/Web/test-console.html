<!DOCTYPE html>
<html lang="zh-CN">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Activity Tracker æµ‹è¯•æ§åˆ¶å°</title>
    
    <!-- AdSense é…ç½® -->
    <meta name="google-adsense-account" content="ca-pub-6680853179152933">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6680853179152933"
         crossorigin="anonymous"></script>
    
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        margin: 0;
        padding: 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
      }

      .container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        border-radius: 12px;
        padding: 30px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      }

      h1 {
        color: #333;
        text-align: center;
        margin-bottom: 30px;
      }

      .test-section {
        margin-bottom: 30px;
        padding: 20px;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        background: #f9f9f9;
      }

      .test-section h3 {
        margin-top: 0;
        color: #667eea;
      }

      .btn {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 6px;
        cursor: pointer;
        margin: 5px;
        font-size: 14px;
        transition: transform 0.2s;
      }

      .btn:hover {
        transform: translateY(-2px);
      }

      .btn-danger {
        background: linear-gradient(135deg, #f5576c 0%, #f093fb 100%);
      }

      .btn-success {
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      }

      .form-group {
        margin-bottom: 15px;
      }

      .form-group label {
        display: block;
        margin-bottom: 5px;
        font-weight: 600;
        color: #333;
      }

      .form-group input,
      .form-group select,
      .form-group textarea {
        width: 100%;
        padding: 8px 12px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 14px;
      }

      .form-group textarea {
        height: 60px;
        resize: vertical;
      }

      .stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
      }

      .stat-card {
        background: white;
        padding: 15px;
        border-radius: 8px;
        text-align: center;
        border: 1px solid #e0e0e0;
      }

      .stat-card .number {
        font-size: 24px;
        font-weight: bold;
        color: #667eea;
      }

      .stat-card .label {
        font-size: 12px;
        color: #666;
        margin-top: 5px;
      }

      .log {
        background: #f5f5f5;
        border: 1px solid #ddd;
        border-radius: 4px;
        padding: 15px;
        height: 200px;
        overflow-y: auto;
        font-family: 'Courier New', monospace;
        font-size: 12px;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <h1>ğŸ§ª Activity Tracker æµ‹è¯•æ§åˆ¶å°</h1>

      <!-- ç»Ÿè®¡ä¿¡æ¯ -->
      <div class="stats">
        <div class="stat-card">
          <div class="number" id="totalActivities">0</div>
          <div class="label">æ€»æ´»åŠ¨æ•°</div>
        </div>
        <div class="stat-card">
          <div class="number" id="todayActivities">0</div>
          <div class="label">ä»Šæ—¥æ´»åŠ¨</div>
        </div>
        <div class="stat-card">
          <div class="number" id="totalProjects">0</div>
          <div class="label">é¡¹ç›®æ•°</div>
        </div>
        <div class="stat-card">
          <div class="number" id="totalDiaries">0</div>
          <div class="label">æ—¥è®°æ•°</div>
        </div>
      </div>

      <!-- å¿«é€Ÿæ“ä½œ -->
      <div class="test-section">
        <h3>ğŸš€ å¿«é€Ÿæ“ä½œ</h3>
        <button class="btn" onclick="insertTestActivity()">æ’å…¥éšæœºæ´»åŠ¨</button>
        <button class="btn" onclick="insertBatchActivities(5)">æ‰¹é‡æ’å…¥5æ¡</button>
        <button class="btn" onclick="insertBatchActivities(10)">æ‰¹é‡æ’å…¥10æ¡</button>
        <button class="btn btn-success" onclick="reloadTestData()">é‡æ–°åŠ è½½æµ‹è¯•æ•°æ®</button>
        <button class="btn btn-danger" onclick="clearAllActivities()">æ¸…ç©ºæ‰€æœ‰æ´»åŠ¨</button>
      </div>

      <!-- è‡ªå®šä¹‰æ´»åŠ¨æ’å…¥ -->
      <div class="test-section">
        <h3>ğŸ“ è‡ªå®šä¹‰æ´»åŠ¨æ’å…¥</h3>
        <div class="form-group">
          <label>æ´»åŠ¨å†…å®¹:</label>
          <input type="text" id="activityText" placeholder="è¾“å…¥æ´»åŠ¨å†…å®¹" value="æµ‹è¯•æ´»åŠ¨">
        </div>
        <div class="form-group">
          <label>åˆ†ç±»:</label>
          <select id="activityCategory">
            <option value="å·¥ä½œ">å·¥ä½œ</option>
            <option value="å­¦ä¹ ">å­¦ä¹ </option>
            <option value="è¿åŠ¨">è¿åŠ¨</option>
            <option value="å¨±ä¹">å¨±ä¹</option>
            <option value="ç”Ÿæ´»">ç”Ÿæ´»</option>
          </select>
        </div>
        <div class="form-group">
          <label>æŒç»­æ—¶é—´(åˆ†é’Ÿ):</label>
          <input type="number" id="activityDuration" value="30" min="1" max="480">
        </div>
        <div class="form-group">
          <label>æ•ˆç‡(%):</label>
          <input type="number" id="activityEfficiency" value="85" min="0" max="100">
        </div>
        <div class="form-group">
          <label>å¿ƒæƒ…:</label>
          <select id="activityMood">
            <option value="productive">productive</option>
            <option value="happy">happy</option>
            <option value="focused">focused</option>
            <option value="relaxed">relaxed</option>
            <option value="tired">tired</option>
          </select>
        </div>
        <div class="form-group">
          <label>æ ‡ç­¾(ç”¨é€—å·åˆ†éš”):</label>
          <input type="text" id="activityTags" placeholder="æ ‡ç­¾1,æ ‡ç­¾2" value="æµ‹è¯•,å¼€å‘">
        </div>
        <button class="btn" onclick="insertCustomActivity()">æ’å…¥è‡ªå®šä¹‰æ´»åŠ¨</button>
      </div>

      <!-- æ•°æ®ç®¡ç† -->
      <div class="test-section">
        <h3>ğŸ’¾ æ•°æ®ç®¡ç†</h3>
        <button class="btn" onclick="exportActivities()">å¯¼å‡ºæ´»åŠ¨æ•°æ®</button>
        <button class="btn" onclick="document.getElementById('importFile').click()">å¯¼å…¥æ´»åŠ¨æ•°æ®</button>
        <input type="file" id="importFile" accept=".json" style="display: none;"
          onchange="importActivities(this.files[0])">
        <button class="btn" onclick="showDataStats()">æ˜¾ç¤ºæ•°æ®ç»Ÿè®¡</button>
      </div>

      <!-- æµ‹è¯•æ—¥å¿— -->
      <div class="test-section">
        <h3>ğŸ“‹ æµ‹è¯•æ—¥å¿—</h3>
        <div class="log" id="testLog"></div>
        <button class="btn" onclick="clearLog()">æ¸…ç©ºæ—¥å¿—</button>
      </div>
    </div>

    <script>
      // æ—¥å¿—åŠŸèƒ½
      function log(message) {
        const logElement = document.getElementById('testLog');
        const timestamp = new Date().toLocaleTimeString();
        logElement.innerHTML += `[${timestamp}] ${message}\n`;
        logElement.scrollTop = logElement.scrollHeight;
      }

      function clearLog() {
        document.getElementById('testLog').innerHTML = '';
      }

      // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
      function updateStats() {
        const activities = JSON.parse(localStorage.getItem('activityTracker_activities') || '[]');
        const projects = JSON.parse(localStorage.getItem('activityTracker_projects') || '[]');
        const diaries = JSON.parse(localStorage.getItem('activityTracker_diary') || '[]');

        const today = new Date();
        today.setHours(0, 0, 0, 0);
        const todayActivities = activities.filter(activity => {
          const activityDate = new Date(activity.startTime);
          activityDate.setHours(0, 0, 0, 0);
          return activityDate.getTime() === today.getTime();
        });

        document.getElementById('totalActivities').textContent = activities.length;
        document.getElementById('todayActivities').textContent = todayActivities.length;
        document.getElementById('totalProjects').textContent = projects.length;
        document.getElementById('totalDiaries').textContent = diaries.length;
      }

      // æ’å…¥è‡ªå®šä¹‰æ´»åŠ¨
      function insertCustomActivity() {
        const activityData = {
          text: document.getElementById('activityText').value,
          category: document.getElementById('activityCategory').value,
          duration: parseInt(document.getElementById('activityDuration').value),
          efficiency: parseInt(document.getElementById('activityEfficiency').value),
          mood: document.getElementById('activityMood').value,
          tags: document.getElementById('activityTags').value.split(',').map(tag => tag.trim()).filter(tag => tag)
        };

        const result = insertActivityRecord(activityData);
        log(`âœ… æ’å…¥è‡ªå®šä¹‰æ´»åŠ¨: ${result.text}`);
        updateStats();
      }

      // æ˜¾ç¤ºæ•°æ®ç»Ÿè®¡
      function showDataStats() {
        const activities = JSON.parse(localStorage.getItem('activityTracker_activities') || '[]');
        const categoryStats = {};

        activities.forEach(activity => {
          categoryStats[activity.category] = (categoryStats[activity.category] || 0) + 1;
        });

        let statsText = 'ğŸ“Š æ•°æ®ç»Ÿè®¡:\n';
        statsText += `æ€»æ´»åŠ¨æ•°: ${activities.length}\n`;
        statsText += 'åˆ†ç±»ç»Ÿè®¡:\n';
        Object.entries(categoryStats).forEach(([category, count]) => {
          statsText += `  ${category}: ${count} æ¡\n`;
        });

        log(statsText);
      }

      // é‡å†™å…¨å±€å‡½æ•°ä»¥æ·»åŠ æ—¥å¿—
      const originalInsertActivityRecord = window.insertActivityRecord;
      window.insertActivityRecord = function (activityData) {
        const result = originalInsertActivityRecord(activityData);
        log(`ğŸ“ æ’å…¥æ´»åŠ¨: ${result.text} (${result.category})`);
        updateStats();
        return result;
      };

      const originalInsertTestActivity = window.insertTestActivity;
      window.insertTestActivity = function () {
        const result = originalInsertTestActivity();
        log(`ğŸ² æ’å…¥éšæœºæ´»åŠ¨: ${result.text} (${result.category})`);
        updateStats();
        return result;
      };

      const originalInsertBatchActivities = window.insertBatchActivities;
      window.insertBatchActivities = function (count) {
        const result = originalInsertBatchActivities(count);
        log(`ğŸ“¦ æ‰¹é‡æ’å…¥ ${count} æ¡æ´»åŠ¨è®°å½•`);
        updateStats();
        return result;
      };

      const originalClearAllActivities = window.clearAllActivities;
      window.clearAllActivities = function () {
        const result = originalClearAllActivities();
        if (result) {
          log('ğŸ—‘ï¸ æ¸…ç©ºæ‰€æœ‰æ´»åŠ¨è®°å½•');
          updateStats();
        }
        return result;
      };

      const originalReloadTestData = window.reloadTestData;
      window.reloadTestData = function () {
        originalReloadTestData();
        log('ğŸ”„ é‡æ–°åŠ è½½æµ‹è¯•æ•°æ®');
        updateStats();
      };

      // åˆå§‹åŒ–
      document.addEventListener('DOMContentLoaded', function () {
        log('ğŸš€ æµ‹è¯•æ§åˆ¶å°å·²å¯åŠ¨');
        updateStats();
      });
    </script>
  </body>

</html>
